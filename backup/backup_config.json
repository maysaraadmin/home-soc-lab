{
  "version": "1.0",
  "backup_root": "/backups/soc",
  "retention_days": 30,
  "tmp_dir": "/tmp/soc_backup",
  "databases": {
    "elasticsearch": {
      "enabled": true,
      "type": "elasticsearch",
      "host": "elasticsearch",
      "port": 9200,
      "username": "elastic",
      "password_env": "ELASTIC_PASSWORD",
      "indices": ["soc-*"],
      "schedule": "0 2 * * *"
    },
    "postgres": {
      "enabled": true,
      "type": "postgres",
      "host": "postgres",
      "port": 5432,
      "database": "cortex",
      "username": "cortex",
      "password_env": "POSTGRES_PASSWORD",
      "schedule": "0 3 * * *"
    },
    "mysql": {
      "enabled": true,
      "type": "mysql",
      "host": "mysql",
      "port": 3306,
      "database": "misp",
      "username": "misp",
      "password_env": "MYSQL_PASSWORD",
      "schedule": "0 4 * * *"
    }
  },
  "files": {
    "configs": {
      "enabled": true,
      "paths": [
        "/etc/soc",
        "/etc/elasticsearch",
        "/etc/nginx"
      ],
      "schedule": "0 1 * * *"
    },
    "logs": {
      "enabled": true,
      "paths": [
        "/var/log/soc"
      ],
      "schedule": "0 5 * * *"
    }
  },
  "notifications": {
    "email": {
      "enabled": false,
      "smtp_server": "smtp.example.com",
      "smtp_port": 587,
      "smtp_user": "backup@example.com",
      "smtp_password_env": "SMTP_PASSWORD",
      "from_address": "backup@example.com",
      "to_addresses": ["admin@example.com"],
      "on_success": true,
      "on_failure": true
    },
    "slack": {
      "enabled": false,
      "webhook_url_env": "SLACK_WEBHOOK_URL",
      "channel": "#soc-backups",
      "on_success": true,
      "on_failure": true
    }
  },
  "encryption": {
    "enabled": false,
    "public_key_file": "/etc/soc/backup_key.pub",
    "recipient": "backup@example.com"
  },
  "verification": {
    "enabled": true,
    "verify_backups": true,
    "keep_verification_logs": true,
    "max_verification_logs": 10
  },
  "cleanup": {
    "enabled": true,
    "keep_daily": 7,
    "keep_weekly": 4,
    "keep_monthly": 12,
    "keep_yearly": 2
  },
  "monitoring": {
    "enabled": true,
    "prometheus_push_gateway": "http://prometheus:9091",
    "metrics_prefix": "soc_backup_"
  }
}
