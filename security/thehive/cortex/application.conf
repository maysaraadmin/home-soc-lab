# Cortex configuration file

# Secret key for session and CSRF tokens
play.http.secret.key = "your-secret-key-here"

# Database configuration
db {
  default {
    driver = "org.postgresql.Driver"
    url = "jdbc:postgresql://postgres:5432/cortex"
    username = "cortex"
    password = "cortex"
    connectionTimeout = 3000
    validationTimeout = 3000
    maxLifetime = 10 minutes
    maxPoolSize = 10
    minIdle = 5
    idleTimeout = 1 minute
  }
}

# Authentication configuration
auth {
  method = [
    {name: session}
    {name: key}
  ]
  basic {
    realm = "Cortex"
  }
}

# HTTP server configuration
http {
  address = "0.0.0.0"
  port = 9001
  ssl {
    keyStore = null
    keyStorePassword = ""
  }
  authentication {
    refresh = 1 hour
  }
}

# Job configuration
job {
  # Number of jobs that can run in parallel
  max-concurrent-jobs = 10
  
  # Time to keep job results (default: 7 days)
  retention-period = 7 days
  
  # Cleanup interval (default: 1 hour)
  cleanup-interval = 1 hour
}

# Cache configuration
cache {
  # Time to live for cached items (default: 60 seconds)
  ttl = 60 seconds
  
  # Maximum number of items in the cache (default: 1000)
  max-size = 1000
}

# Analyzer configuration
analyzer {
  # Path to the analyzer directory
  path = "/opt/cortex/analyzers"
  
  # Number of analyzer processes to keep running
  fork-join-executor {
    # Minimal number of threads to cap factor-based parallelism number to
    parallelism-min = 2
    # Parallelism (threads) ... ceil(available processors * factor)
    parallelism-factor = 2.0
    # Max number of threads to cap factor-based parallelism number to
    parallelism-max = 4
  }
}

# Responder configuration
responder {
  # Path to the responder directory
  path = "/opt/cortex/responders"
  
  # Number of responder processes to keep running
  fork-join-executor {
    # Minimal number of threads to cap factor-based parallelism number to
    parallelism-min = 2
    # Parallelism (threads) ... ceil(available processors * factor)
    parallelism-factor = 2.0
    # Max number of threads to cap factor-based parallelism number to
    parallelism-max = 4
  }
}

# Elasticsearch configuration
elasticsearch {
  # Comma-separated list of Elasticsearch nodes
  uri = "http://elasticsearch:9200"
  
  # Index name
  index = "cortex"
  
  # Number of shards (default: 5)
  index-settings.number_of_shards = 1
  
  # Number of replicas (default: 1)
  index-settings.number_of_replicas = 0
  
  # Refresh interval (default: 1s)
  index-settings.refresh_interval = "1s"
  
  # Bulk size (default: 1000)
  bulk-size = 1000
  
  # Bulk actions (default: 1000)
  bulk-actions = 1000
  
  # Bulk flush interval (default: 5s)
  bulk-flush-interval = 5s
  
  # Bulk concurrent requests (default: 2)
  bulk-concurrent-requests = 2
}

# TheHive configuration
thehive {
  # TheHive URL (for report templates)
  url = "http://thehive:9000"
  
  # TheHive API key
  key = "your-thehive-api-key-here"
}

# MISP configuration
misp {
  # MISP URL (for report templates)
  url = "http://misp"
  
  # MISP API key
  key = "your-misp-api-key-here"
}

# Logging configuration
logger {
  # Root logger
  root = ERROR
  
  # Application logger
  play = INFO
  
  # Framework loggers
  akka = WARN
  
  # Database loggers
  org.hibernate = WARN
  
  # Elasticsearch loggers
  org.elasticsearch = WARN
  
  # Application loggers
  controllers = INFO
  models = INFO
  services = INFO
  
  # Custom loggers
  org.threeten.bp = WARN
  com.sksamuel.elastic4s = WARN
  org.apache.http = WARN
  org.reflections = ERROR
}
